
<?xml version="1.0" encoding="UTF-8"?>
<metadata:MetadataProvider id="SWITCHaaiMD" xmlns:metadata="urn:mace:shibboleth:2.0:metadata"
                           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                           xsi:type="metadata:FileBackedHTTPMetadataProvider"
                           xsi:schemaLocation="urn:mace:shibboleth:2.0:metadata http://shibboleth.net/schema/idp/shibboleth-metadata.xsd"
                           metadataURL="http://metadata.aai.switch.ch/metadata.switchaai.xml"
                           backingFile="/opt/shibboleth-idp/metadata/metadata.switchaai.xml"
                           proxyHost="%{idp.http.proxyhost:}" proxyPort="%{idp.http.proxyport:8080}"
                           requireValidMetadata="true"
                           maxRefreshDelay="PT1H">
    <metadata:MetadataFilter xsi:type="metadata:ChainingFilter">
        <metadata:MetadataFilter xsi:type="metadata:RequiredValidUntil"
                                 maxValidityInterval="P7D" />
        <metadata:MetadataFilter xsi:type="metadata:SignatureValidation">
            <security:TrustEngine id="SWITCHaaiTrustEngine" xmlns:security="urn:mace:shibboleth:2.0:security"
                                  xsi:schemaLocation="urn:mace:shibboleth:2.0:security http://shibboleth.net/schema/idp/shibboleth-security.xsd"
                                  xsi:type="security:StaticPKIXSignature">
                <security:TrustedName>SWITCHaai Metadata Signer</security:TrustedName>
                <security:ValidationInfo id="SWITCHaaiFederationCredentials"
                                         xsi:type="security:PKIXResourceBacked"
                                         verifyDepth="2">
                    <security:Certificate>/opt/shibboleth-idp/credentials/SWITCHaaiRootCA.crt.pem</security:Certificate>
                </security:ValidationInfo>
                <security:ValidationOptions xsi:type="security:CertPathValidationOptionsType"
                                            forceRevocationEnabled="true"
                                            policyMappingInhibit="true"
                                            anyPolicyInhibit="true">
                    <security:PolicyOID>2.16.756.1.2.6.7</security:PolicyOID>
                </security:ValidationOptions>
            </security:TrustEngine>
        </metadata:MetadataFilter>
        <metadata:MetadataFilter xsi:type="metadata:EntityRoleWhiteList" xmlns:samlmd="urn:oasis:names:tc:SAML:2.0:metadata"
                                 xsi:schemaLocation="urn:oasis:names:tc:SAML:2.0:metadata http://docs.oasis-open.org/security/saml/v2.0/saml-schema-metadata-2.0.xsd">
            <metadata:RetainedRole>samlmd:SPSSODescriptor</metadata:RetainedRole>
        </metadata:MetadataFilter>
    </metadata:MetadataFilter>
</metadata:MetadataProvider>
